# Text-to-Speech Service - Standalone Stack
# For integrated deployment, use the main docker-compose.yml instead
#
# Primary TTS: Chatterbox (see ../chatterbox/)
# This file is kept for reference/alternative TTS options

services:
  # ==========================================================================
  # Alternative: Fish Speech (for multilingual/voice cloning)
  # Note: CC-BY-NC-SA license on model weights (non-commercial)
  # Uncomment to use instead of Chatterbox
  # ==========================================================================
  fish-speech:
    build:
      context: https://github.com/moyutegong/fish-speech-rocm.git
      dockerfile: dockerfile
    container_name: fish-speech
    restart: unless-stopped
    ports:
      - "${FISH_SPEECH_PORT:-8881}:8080"
    environment:
      - HSA_OVERRIDE_GFX_VERSION=${HSA_OVERRIDE_GFX_VERSION:-11.0.1}
    volumes:
      - ${TTS_MODELS:-./models}:/app/models
    devices:
      - /dev/kfd
      - /dev/dri
    group_add:
      - "44"   # video
      - "992"  # render
    security_opt:
      - seccomp:unconfined
    ipc: host
    networks:
      - ai-stack
    profiles:
      - fish  # Only start with: docker compose --profile fish up

networks:
  ai-stack:
    name: ${DOCKER_NETWORK:-ai-stack}
    external: true
